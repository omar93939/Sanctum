{% extends "profile/banner.njk" %}

{% block extrahead %}
  <title>{{ displayname or username }}'s Videos</title>
  <link rel="canonical" href="https://sanctum.{{ DOMAIN }}/profile/{{ username }}/gallery/videos">
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.umd.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.css"/>
{% endblock %}

{% block content %}

  {% if username == session.username and session.type >= 4 %}
    <div class="section">
      <div id="add-video-wrapper">
        <a id="add-video-button" href="/upload/galvideo">
          <svg id="add-video-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M0 128C0 92.7 28.7 64 64 64l256 0c35.3 0 64 28.7 64 64l0 256c0 35.3-28.7 64-64 64L64 448c-35.3 0-64-28.7-64-64L0 128zM559.1 99.8c10.4 5.6 16.9 16.4 16.9 28.2l0 256c0 11.8-6.5 22.6-16.9 28.2s-23 5-32.9-1.6l-96-64L416 337.1l0-17.1 0-128 0-17.1 14.2-9.5 96-64c9.8-6.5 22.4-7.2 32.9-1.6z"/></svg>
        <br>
        Upload Now!
        </a>
      </div>
    </div>
  {% endif %}

  <div class="section">
    <div id="gallery-button-wrapper">
        <a href="/profile/{{ username }}/gallery" class="gal-buttons">Back</a>
        <button type="button" class="gal-buttons" id="order-by" onclick="changeOrder(this)">Most Recent</a>
    </div>
    <ul class="gallery-wrapper" id="gallery-wrapper">
      {% for video in videos %}
        <li class="video-container">
          <div class="video-thumbnail">
            {# <div class="preview-progress-bar"></div> #}
            {% if video.VideoUID | length == 32 %}
              <a class="video-thumbnail-link gallerythumbnail" href="https://sanctum.b-cdn.net/{{ bunnyInfo.streamstorage }}/vid/{{ video.VideoUID }}.webp" data-fancybox="videos" data-caption="{{ video.Title }}">
                <img loading="lazy" src="https://sanctum.b-cdn.net/{{ bunnyInfo.streamstorage }}/vid/{{ video.VideoUID }}.webp" alt="Video Thumbnail" height="180" onerror="this.onerror=null;this.src='/images/Processing.png';this.dataset.img='/images/Processing.png';">
              </a>
            {% else %}
              <a class="video-thumbnail-link gallerythumbnail" href="https://iframe.mediadelivery.net/embed/{{ bunnyInfo.libraryid }}/{{ video.VideoUID }}?autoplay=false" data-fancybox="videos" data-caption="{{ video.Title }}" data-type="iframe">
                <svg class="play-vid" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80L0 432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg>
                <img loading="lazy" src="https://{{ STREAM_HOSTNAME }}.b-cdn.net/{{ video.VideoUID }}/thumbnail.jpg?{{ video.ThumbChanges }}" alt="Video Thumbnail" height="180" onerror="this.onerror=null;this.src='/images/Processing.png';this.dataset.img='/images/Processing.png';">
              </a>
            {% endif %}
          </div>
          <div class="video-thumbnail-info-wrapper clearfix">
            <div class="video-details-wrapper">
              {% if username == session.username %}
                <a class="edit-video-button" href="/editgal/{{ video.VideoUID }}" class="">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--!Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M471.6 21.7c-21.9-21.9-57.3-21.9-79.2 0L362.3 51.7l97.9 97.9 30.1-30.1c21.9-21.9 21.9-57.3 0-79.2L471.6 21.7zm-299.2 220c-6.1 6.1-10.8 13.6-13.5 21.9l-29.6 88.8c-2.9 8.6-.6 18.1 5.8 24.6s15.9 8.7 24.6 5.8l88.8-29.6c8.2-2.7 15.7-7.4 21.9-13.5L437.7 172.3 339.7 74.3 172.4 241.7zM96 64C43 64 0 107 0 160L0 416c0 53 43 96 96 96l256 0c53 0 96-43 96-96l0-96c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 96c0 17.7-14.3 32-32 32L96 448c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l96 0c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 64z"/></svg>
                  <span>Edit</span>
                </a>
              {% endif %}
            </div>
          </div>
        </li>
      {% endfor %}
      <script>
        Fancybox.bind("[data-fancybox]");
      </script>
    </ul>
  </div>

{% endblock %}